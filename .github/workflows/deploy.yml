name: Deploy to VPS
on:
  push:
    branches:
      - main
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout source code
      uses: actions/checkout@v2

    - name: Install Dependencies
      run: |
        cd /root/todo_app/my-app
        npm install
    - name: Build and Package
      run: |
        cd /root/todo_app/my-app
        npm run build
        tar -zcvf build.tar.gz build
    - name: Deploy to VPS
      uses: appleboy/ssh-action@v0.19.0
      with:
        host: 45.146.166.151
        username: latypov12
        password: ${{ secrets.SSH_PASSWORD }}
        script: |
          mkdir -p /var/www/your-react-app
          cd /var/www/your-react-app
          rm -rf *
          tar -zxvf $HOME/build.tar.gz
